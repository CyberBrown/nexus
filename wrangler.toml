name = "nexus"
main = "src/index.ts"
compatibility_date = "2024-01-01"

[dev]
port = 8787

[[d1_databases]]
binding = "DB"
database_name = "nexus-db"
database_id = "1210076d-a443-443c-8623-a02b5ff4de9f"

[vars]
ENVIRONMENT = "development"
# Cloudflare Access - set these for production auth
# TEAM_DOMAIN = "https://your-team.cloudflareaccess.com"
# POLICY_AUD = "your-application-audience-tag"

[[kv_namespaces]]
binding = "KV"
id = "4a9097857e284189a3f0dc6211b7fb3f"

[[durable_objects.bindings]]
name = "INBOX_MANAGER"
class_name = "InboxManager"

[[durable_objects.bindings]]
name = "CAPTURE_BUFFER"
class_name = "CaptureBuffer"

[[durable_objects.bindings]]
name = "SYNC_MANAGER"
class_name = "SyncManager"

[[durable_objects.bindings]]
name = "USER_SESSION"
class_name = "UserSession"

[[durable_objects.bindings]]
name = "IDEA_EXECUTOR"
class_name = "IdeaExecutor"

[[migrations]]
tag = "v1"
new_sqlite_classes = ["InboxManager"]

[[migrations]]
tag = "v2"
new_sqlite_classes = ["CaptureBuffer"]

[[migrations]]
tag = "v3"
new_sqlite_classes = ["SyncManager"]

[[migrations]]
tag = "v4"
new_sqlite_classes = ["UserSession"]

[[migrations]]
tag = "v5"
new_sqlite_classes = ["IdeaExecutor"]

# Cron Triggers
[triggers]
crons = ["0 0 * * *"]  # Run daily at midnight UTC
